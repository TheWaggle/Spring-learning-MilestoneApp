# ログインの実装

* Spring boot securityを追加しよう。
  Spring-boot-starter-security
  Spring-security-test
  thymeleaf-extras-springsecurity5

maven add dependicyにて追加する。

pom.xmlに追加されていることを確認

```xml
		<dependency>
			<groupId>org.springframework.security</groupId>
			<artifactId>spring-security-test</artifactId>
			<version>5.6.1</version>
		</dependency>


		<dependency>
			<groupId>org.thymeleaf.extras</groupId>
			<artifactId>thymeleaf-extras-springsecurity5</artifactId>
			<version>3.1.0.M1</version>
		</dependency>


		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-security</artifactId>
			<version>2.6.3</version>
		</dependency>
```

上記を追加して、実行すると、ターミナルに以下のように一時的なパスワードが表示されます。これをパスワード欄に入れてログインします。
ユーザー名は user としてください。

Using generated security password: deb36f12-11e4-4887-8f9d-983ad887c8a1　<- この値は、人それぞれ違います。

![ログイン画面](/README-assets/login.png)

無事にログインを確認できたら、オリジナルのログインページを作成していきます。

1. index.htmlと同じ階層にlogin.htmlを作成します。中身は、とりあえず、index.htmlのコピーに追記して仮のログインページとしておいてください。
2. 続いて、IndexController.javaにlogin.htmlのルート処理をGetMapping("/login")で追加します。
3. 次に demo/src/main/java/com/example/mils/demo/config フォルダを作成します。
    configパッケージには、アプリケーションの設定に関するクラスをパッケージします。
4. configパッケージ内に SecurityConfigクラス を作成します。

SecurityConfiクラスには以下のほぼ提携文見たいなものを入れてください。
```java
@EnableWebSecurity //セキュリティ関連を示すアノテーション
public class SecurityConfig extends WebSecurityConfigurerAdapter{
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
            .authorizeRequests()
            .mvcMatchers("/login**").permitAll()
            .anyRequest().authenticated()
            .and()
            .formLogin()
            .loginPage("/login");
    }
```

これで、トップページにアクセスし、先ほど作ったログインページへ遷移すれば成功です。